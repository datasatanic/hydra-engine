# infra name
site_name: ccfa-stage-pc # [ ] CHANGEME 1
is_dev_environment: false

ccfa_version: 0.1.0-pc  # [ ] CHANGEME 2
# Name of module with control host deployment and configuration. Possible values: cnhost, corehost,
control_module_name: cnhost

# provisioning mode supports `internal` and `external` modes
provisioning:
  mode: external # internal
  # vars to control provisioning stages. Currently on `external` mode uses them
  preprovision: false
  postprovision: true
  # preprovision: true
  # postprovision: false

# MGMT site params
mgmt:
  state:
    subnet_name: mgmt
    dc: ccfa-mgmt
    host_number: 21 # [ ] CHANGEME 3
  repos:
    subnet_name: mgmt
    repohost_number: 21 # [ ] CHANGEME 3

site:
  avg_cpu_core_hz: 2500 # [ ] CHANGEME 4

# base site parameters
preset: 10_tps_single_site_pc # [ ] CHANGEME 5

providers:
  cloud: vSphereWithNSX # [ ] CHANGEME 6 Provider to deploy VMs and Networks

dns: # [ ] CHANGEME 7
  recursors:
  - 10.74.10.21
  - 10.74.10.22
  - 10.74.10.23
  - 10.74.10.24
  - 10.74.10.25
  forwarded_zones: []


enabled_hosts: # [ ] CHANGEME 8
- cnhost
  # - basehost
  # - pgephost
  # - pghost
  # - opensearchhost
  # - logaggregationhost
  # - victoriametricshost
  # - s3storagehost
  # - redishost

# Separated module version for each hostgroup for convinience purpose
refs:
  hosts: {}

# hosts configuration
hosts:
  images: # vm images
  - type: vendor
    name: golden-test   # [ ] CHANGEME 9
  - type: cnhost
    name: "cnhost-${ for image in common.hosts.images: image.type => image.name }['vendor']"
  - type: basehost
    name: "basehost-${ for image in common.hosts.images: image.type => image.name
      }['vendor']"
  - type: pghost
    name: "pghost-${ for image in common.hosts.images: image.type => image.name }['vendor']"
  - type: opensearchhost
    name: "opensearchhost-${ for image in common.hosts.images: image.type => image.name
      }['vendor']"

# Terraform backend configurations
backend:
  consul:
    address: '${ cidrhost({for network in common.networks: network.name => network}[common.mgmt.state.subnet_name].CIDR,
      common.mgmt.state.host_number)}:8500'
    dc: ${ common.mgmt.state.dc }
    token: ''

## Cloud init params
cloudInit:
  provisionVM:
    timeout: 600 # timeout in seconds
    destinationFolderPath: /etc/provision/provisionVM
    destinationInventoryFolderPath: /etc/provision/cloud_init_provision/ansible/dynamic
  cloudInitProvision:
    destinationFolderPath: /etc/provision/cloud_init_provision

# k8s cluster configuration
k8s:
  containerRegistryAuthSecretName: docker-registries-credentials
  api_endpoint_ip: '${ cidrhost({for network in common.networks: network.name => network}[common.vm.subnet_name].CIDR,
    21)}'
  use_k8s: true
  storage:
    volumes:
    - name: opensearch-volume
      capacity_gb: 200   # [ ] CHANGEME 10
      host_path: /data/volumes/opensearch
      node_affinity:
        keys:
        - opensearchhost
        label: host-type
    - name: vmstorage-volume
      capacity_gb: 50   # [ ] CHANGEME 10
      host_path: /data/volumes/vmstorage
      node_affinity:
        keys:
        - victoriametricshost
        label: host-type
    - name: minio-volume
      capacity_gb: 50   # [ ] CHANGEME 10
      host_path: /data/volumes/minio
      node_affinity:
        keys:
        - s3storagehost
        label: host-type
    - name: redis-volume
      capacity_gb: 50
      host_path: /data/volumes/redis
      node_affinity:
        keys:
        - redishost
        label: host-type
    volume_claims:
    - name: opensearch-volume-claim
      access_modes:
      - ReadWriteOnce
      capacity_gb: 200   # [ ] CHANGEME 10
      storage_class_name: local-storage
      volume_name: opensearch-volume
    - name: vmstorage-volume-claim
      access_modes:
      - ReadWriteOnce
      capacity_gb: 50   # [ ] CHANGEME 10
      storage_class_name: local-storage
      volume_name: vmstorage-volume
    - name: redis-volume-claim
      access_modes:
      - ReadWriteOnce
      capacity_gb: 50
      storage_class_name: local-storage
      volume_name: redis-volume
    - name: minio-volume-claim
      access_modes:
      - ReadWriteOnce
      capacity_gb: 50   # [ ] CHANGEME 10
      storage_class_name: local-storage
      volume_name: minio-volume

#### vSphere parametrs.
##### Used for creation VM
vsphere: # [ ] CHANGEME 11
  datacenter: vsphere.mcdevops   # Datacenter name in vCenter
  domain: vsphere.mcdevops.compassplus.com   # Domain for VM configuration
  domain_description: CCFA DEV   # Domain name, used for VM description
  content_library_name: Templates   # The name of content library to store and get templates
  vCenter_folder: ccfa-final-test # Main folder, where VM should be placed. Should be exist before creation VM.
    # Subfolders used in CCFA project: basehosts, cnhosts, gwhosts, opensearchhosts, otherhosts, pganomalyhosts, pghosts, victoriametricshosts
  enable_memory_reservation: true
  resource_pool: Main-cluster

# VCD settings
vcd:
  templates_catalog: Templates   # [ ] CHANGEME 12
  enable_memory_reservation: true

# VM global configs
vm:
  domain: ${ common.site_name }   # Domain user for VM names. Result VM name: <name>.<vm_domain>
  subnet_name: vxlan-106-dvaraksin   # Subnet name in vCenter, where VM will be placed # [ ] CHANGEME 13
  subnet_CIDR: '${{ for network in common.networks: network.name => network}[common.vm.subnet_name].CIDR
    }'                                                                                                      # Subnet CIDR in vCenter, where VM will be placed

# Network Configuration
networks:
- name: vxlan-106-dvaraksin   # [ ] CHANGEME 14
  CIDR: 10.74.106.0/24     # [ ] CHANGEME 14
- name: mgmt
  CIDR: 10.74.106.0/24     # [ ] CHANGEME 14
- name: repos
  CIDR: 10.74.106.0/24     # [ ] CHANGEME 14
- name: k8s-pods
  CIDR: 10.33.0.0/16
- name: k8s-services
  CIDR: 10.66.0.0/16


patroni:
  allowed_networks:
  - vxlan-106-dvaraksin   # [ ] CHANGEME 15
  - k8s-pods
  - k8s-services
  repository_name: db_scripts-raw

# infrastructure layout
component_groups:
  # - name: fp
  # - name: ep
- name: infra
  components:
  - name: core
    subcomponents:
    - name: service_metrics_exporter
  - name: monitoring
    subcomponents:
    - name: prometheus
      services:
      - name: alert_rules

# Consul config
consul:
  lic_position: infra/core/hashicorp
  config:
    dc: ${ common.site_name }
    address: '${ cidrhost({for network in common.networks: network.name => network}[common.vm.subnet_name].CIDR,
      21)}:8500'
    connection_schema: http
  kv:
    deploy_old: true
    version: v1
  k8s:
    chart_version: v1.2.1
    catalogSync:
      image: hashicorppreview/consul-k8s-control-plane
      tag: 1.4-dev
      registry_name: nexus_dockerRegistry_hashicorppreview

# Nexus endpoints. Used for ansible-playbooks and Nomad jobs
registries:
  nexus_dockerRegistry_URL: '${cidrhost({for network in common.networks: network.name
    => network}[common.mgmt.repos.subnet_name].CIDR, common.mgmt.repos.repohost_number)}:8950'
  nexus_dockerRegistry_gitlab_CCFA_URL: '${cidrhost({for network in common.networks:
    network.name => network}[common.mgmt.repos.subnet_name].CIDR, common.mgmt.repos.repohost_number)}:8951'
  nexus_dockerRegistry_nexus_dev_URL: '${cidrhost({for network in common.networks:
    network.name => network}[common.mgmt.repos.subnet_name].CIDR, common.mgmt.repos.repohost_number)}:8952'
  nexus_dockerRegistry_quayio_URL: '${cidrhost({for network in common.networks: network.name
    => network}[common.mgmt.repos.subnet_name].CIDR, common.mgmt.repos.repohost_number)}:8953'
  nexus_dockerRegistry_mcdevops: '${cidrhost({for network in common.networks: network.name
    => network}[common.mgmt.repos.subnet_name].CIDR, common.mgmt.repos.repohost_number)}:8954'
  nexus_dockerRegistry_ghcrio_slavickk_URL: '${cidrhost({for network in common.networks:
    network.name => network}[common.mgmt.repos.subnet_name].CIDR, common.mgmt.repos.repohost_number)}:8955'
  nexus_dockerRegistry_ccfa_cicd: '${cidrhost({for network in common.networks: network.name
    => network}[common.mgmt.repos.subnet_name].CIDR, common.mgmt.repos.repohost_number)}:8956'                                                                                         # images built with Jenkins
  nexus_dockerRegistry_registry_k8s_io: '${cidrhost({for network in common.networks:
    network.name => network}[common.mgmt.repos.subnet_name].CIDR, common.mgmt.repos.repohost_number)}:8957'                                                                                  # k8sAgent_k8sImageRepository
  nexus_dockerRegistry_hashicorppreview: '${cidrhost({for network in common.networks:
    network.name => network}[common.mgmt.repos.subnet_name].CIDR, common.mgmt.repos.repohost_number)}:8958'

minio:
  endpoint: minio-np-api.service.${ common.site_name }.consul:30029
  ssl: false
  region: ru
  buckets:
  - name: vm-backup
    purpose: victoriaMetrics     # TODO: Document var
    expirationDays: 7
  - name: test
    purpose: test
    expirationDays: 1

groups:
  admins:
    roles:
      vault:
      - admins
      opensearch:
      - admin
      keycloak:
      - admin
      openshiftConsole:
      - admins
      grafana:
      - grafanaadmin
    members:
    - infra_admin
  CCFA_admins:
    roles:
      webApiRulesSupport:
      - rule:read
      - rule:write
      - rule:execute
      - stream:read
      referenceDataLoader:
      - dict:read
      - dict:write
      - range:read
      - range:write
      - schema:read
      - schema:write
      riskOperatorWorkplace:
      - administrator
      - operator
      - supervisor
      grafana:
      - editor
      searchEngine:
      - access
    members:
    - ccfa_admin
  risk_analysts:
    roles:
      webApiRulesSupport:
      - rule:read
      - rule:write
      - rule:execute
      - stream:read
      - rule:read
      referenceDataLoader:
      - dict:read
      - dict:write
      - range:read
      - range:write
      - schema:read
      - schema:write
      searchEngine:
      - access
      grafana:
      - editor
    members:
    - risk_analyst
  row_administrators:
    roles:
      riskOperatorWorkplace:
      - administrator
      grafana:
      - editor
    members:
    - row_administrator
  row_operator:
    roles:
      riskOperatorWorkplace:
      - operator
      grafana:
      - editor
    members:
    - row_operator
  row_supervisor:
    roles:
      riskOperatorWorkplace:
      - supervisor
      grafana:
      - editor
    members:
    - row_supervisor

roles:
  webApiRulesSupport:
  - rule:read
  - rule:write
  - rule:execute
  - stream:read
  referenceDataLoader:
  - dict:read
  - dict:write
  - range:read
  - range:write
  - schema:read
  - schema:write
  riskOperatorWorkplace:
  - administrator
  - operator
  - supervisor
  vault:
  - admins
  - default
  opensearchDashboards:
  - admin
  - security_rest_api_full_access
  - os_role_security_api
  - os_role_opensearch_dashboards_user
  - all_access
  keycloak:
  - admin
  openshiftConsole:
  - admins
  grafana:
  - grafanaadmin
  - admin
  - editor
  - viewer
  searchEngine:
  - access

users:
- infra_admin
- ccfa_admin
- risk_analyst
- row_operator
- row_administrator
- row_supervisor

vault:
  endpoints: 'https://${ cidrhost({for network in common.networks: network.name =>
    network}[common.vm.subnet_name].CIDR, 21)}:8200'
  ca_folder_path: artifacts/pki


telegram_channelID: '-1002119225093' # Channel for telegram bot. Location: \\192.168.75.197\mcdevops\keepass\MGNvSphere.kdbx Folder: Telegram

bash_rc_configs:
  clusterTag: ccfa_Stage   # [ ] CHANGEME 16
  clusterColor: MAGENTA
  folderTag: ${ common.site_name }
  folderColor: YELLOW

opensearch: # Endpoint for opensearch. Used in terraform project opensearch for creation users.
  endpoints: https://opensearch-np-api.service.${ common.site_name }.consul:30018
  memory: 8g   # [ ] CHANGEME 17
  ismPolicies:
    index_readonly_timeout: 1d
    index_deletion_timeout: 13d
    index_pattern: alpha-chelgrp-*

grafana:
  git_repository: mcdevops1/grafanaDashboards
  git_branch: ${ common.site_name }   # TODO: parametrize from site name
  git_server: gitlab.com

keycloak:
  endpoint: https://keycloak-np.service.${ common.site_name }.consul:30017
  tls_insecure_skip_verify: false
  realm_name: CCFA
  services:
    webApiRulesSupport:
      service_name: webApiRulesSupport
    #   valid_redirect_uris:
    #     - "http://webapirulessupport-np.service.${ common.site_name }.consul:<nodePorts.webApiRulesSupport.http>/openid-callback"
    webApiRulesSupport-swagger:
      service_name: webApiRulesSupport-swagger
    #   valid_redirect_uris:
    #     - "http://webapirulessupport-np.service.${ common.site_name }.consul:<nodePorts.webApiRulesSupport.http>/swagger/oauth2-redirect.html"
    riskOperatorWorkplace:
      service_name: riskoperatorworkplace
    #   valid_redirect_uris:
    #     - "https://riskoperatorworkplace-np.service.${ common.site_name }.consul:<nodePorts.riskOperatorWorkplace.http>/authentication/login-callback"
    #   valid_post_logout_redirect_uris:
    #     - "https://riskoperatorworkplace-np.service.${ common.site_name }.consul:<nodePorts.riskOperatorWorkplace.http>/authentication/logout-callback"
    referenceDataLoader:
      service_name: ReferenceDataLoader
    referenceDataLoader-swagger:
      service_name: ReferenceDataLoader-swagger
    #   valid_redirect_uris:
    #     - "http://referencedataloader-np.service.${ common.site_name }.consul:<nodePorts.referenceDataLoader.https>/api/v1/docs/oauth2-redirect"
    rulesDeveloperWorkspace:
      service_name: RulesDeveloperWorkspace
    #   valid_redirect_uris:
    #     - "https://rulesdeveloperworkspace-np.service.${ common.site_name }.consul:<nodePorts.rulesDeveloperWorkspace.http>/authentication/login-callback"
    #   valid_post_logout_redirect_uris:
    #     - "https://rulesdeveloperworkspace-np.service.${ common.site_name }.consul:<nodePorts.rulesDeveloperWorkspace.http>/authentication/logout-callback"
    searchEngine:
      service_name: SearchEngine
    #   valid_redirect_uris:
    #     - "http://searchengine-np.service.${ common.site_name }.consul:<nodePorts.searchEngine.http>/docs/oauth2-redirect"
    searchEngine-swagger:
      service_name: SearchEngine-swagger
    #   valid_redirect_uris:
    #     - "http://searchengine-np.service.${ common.site_name }.consul:<nodePorts.searchEngine.http>/docs/oauth2-redirect"
    grafana:
      service_name: grafana
    #   valid_redirect_uris:
    #     - "http://grafana-np.service.${ common.site_name }.consul:<nodePorts.grafana.http>/login/generic_oauth"
    #   root_url: "http://grafana-np.service.${ common.site_name }.consul:<nodePorts.grafana.http>"
    #   web_origins:
    #     - "http://grafana-np.service.${ common.site_name }.consul:<nodePorts.grafana.http>"
    #   valid_post_logout_redirect_uris:
    #     - "http://grafana-np.service.${ common.site_name }.consul:<nodePorts.grafana.http>/login"
    opensearchDashboards:
    ccfa_cli:

nodePorts:
  webApiRulesSupport:
    http: 30012
  riskOperatorWorkplace:
    http: 30031
  referenceDataLoader:
    https: 30032
  rulesDeveloperWorkspace:
    http: 30030
  searchEngine:
    http: 30013
  grafana:
    http: 30023
  opensearchDashboards:
    http: 30021

endpoints:
  serviceMetricExporter:
    http: 8089
  grafana:
    http: 3000
  keycloak:
    https: 443
    cache: 7800
  grafanaExporter:
    http: 443
  jenkins-server:
    http: 8080
  redis-cluster:
    client: 6379
    cluster: 16379
  minio:
    http-api: 9000
    http-console: 9001
  postgresqlExporter:
    http: 9187
  prometheusPushGateway:
    http: 9091
  prometheusBot:
    http: 9087
  alertmanager:
    http: 9093
  victoriaMetrics:
    VMSelect:
      http: 8481
    vminsert:
      http: 8480
    vmalert:
      http: 8880
    vmselect:
      http: 8481
    vmagent:
      http: 8429
    vmstorage:
      http: 8482
      vmselect-in-tcp: 8401
      vminsert-in-tcp: 8400
  nginx:
    http: 443
  jaegerTool:
    jaeger-ui: 16686
    jaeger-agent: 6831
  fluentd-forwarder:
    tcp-forward: 5140
    http-metrics: 5141
    http-listener: 5142
  fluentbit-forwarder:
    tcp-forward: 5140
    http-metrics: 5141
    http-listener: 5142
  fluentd-aggregator:
    tcp-forward: 5140
    http-metrics: 5141
    http-listener: 5142
  opensearch:
    opensearch-api: 9200
    opensearch-node: 9300
    opensearch-perf: 9600
  opensearchDashboards:
    http: 5601
  orexAD:
    http: 8008
  ad2db:
    grpc: 5000
  rexLoadTest:
    http: 80
  chronicler:
    grpc: 5000
  rex:
    http: 80
  webApiRulesSupport:
    http: 443
  watcherRedirector:
    http: 80
  nginxRexGw:
    http: 80
  gatekeeper:
    http: 80
  referenceDataLoader:
    https: 443
  searchEngine:
    http: 8084
  geocache:
    grpc: 5000
  riskOperatorWorkplace:
    http: 443
  rulesDeveloperWorkspace:
    http: 443
  dmcl:
    http: 443
  fastReport:
    http: 8008
  camunda:
    http: 8080
  integrationUtility:
    tx:
      service: 80
      client: 8080
    two:
      service: 80
      client: 8080
  ccfa-docs:
    http: 18082
  openshiftConsole:
    http: 80
  orexpg:
    grpc_port:
  orexpgMaintenance:
    http: 5085
  metricsServer:
    https: 4443
  csExternalTask:
    http: 80
  orex-operator:
    http: 8001

jobs:
  enabled_services: # enabled services in this site, used to set count for generated services from service_list
    stateful:
      # [] # [ ] CHANGEME 17
    - keycloak
    - minio
    - opensearch
    stateless:
      # [] # [ ] CHANGEME 17
      # - camunda
      # - dmcl
      # - fastReport
      # - integrationUtility-two
      # - integrationUtility-tx
      # - jaegerTool
      # - rexLoadTest
      # - riskOperatorWorkplace
    - ad2db
    - alertmanager
    - ccfa-docs
    - chronicler
    - csExternalTask
    - fluentd-aggregator
    - fluentd-forwarder
    - gatekeeper
    - geocache
    - grafana
    - grafanaExporter
    - metricsServer
    - nginxRexGw
    - opensearchDashboards
    - openshiftConsole
    - orexAD
    - orex-operator
    - orexpgMaintenance
    - postgresqlExporter
    - prometheusBot
    - prometheusPushGateway
    - redis-cluster
    - referenceDataLoader
    - rex
    - rulesDeveloperWorkspace
    - searchEngine
    - serviceMetricExporter
    - victoriaMetrics
    - watcherRedirector
    - webApiRulesSupport
  services_list: # all services used in this site, used to generate tf code with modules
    stateful:
      # []
    - keycloak
    - minio
    - opensearch

    stateless:
      # [] # [ ] CHANGEME 17
      # - camunda
      # - fastReport
      # - integrationUtility-two
      # - integrationUtility-tx
      # - jaegerTool
      # - rexLoadTest
      # - riskOperatorWorkplace
    - ad2db
    - alertmanager
    - ccfa-docs
    - chronicler
    - csExternalTask
    - dmcl
    - fluentd-aggregator
    - fluentd-forwarder
    - gatekeeper
    - geocache
    - grafana
    - grafanaExporter
    - metricsServer
    - nginxRexGw
    - opensearchDashboards
    - openshiftConsole
    - orexAD
    - orex-operator
    - orexpgMaintenance
    - postgresqlExporter
    - prometheusBot
    - prometheusPushGateway
    - redis-cluster
    - referenceDataLoader
    - rex
    - rulesDeveloperWorkspace
    - searchEngine
    - serviceMetricExporter
    - victoriaMetrics
    - watcherRedirector
    - webApiRulesSupport

# locactions configuration
# servers list,  used both in distributive building/supplying and in infrastructure deployment
servers:
- name: nexus   # server name, used to link servers and configs, which use them
  address: '${ cidrhost({for network in common.networks: network.name => network}[common.mgmt.repos.subnet_name].CIDR,
    common.mgmt.repos.repohost_number) }'                                                                                                                      #  FQDN or IP address of the server without protocol prefix. Commonly - IP address of repohost1
  port: 443   # default port of the server, optional(INTEGER)
- name: ccfa_git   # server name, used to link servers and configs, which use them
  address: '${ cidrhost({for network in common.networks: network.name => network}[common.mgmt.repos.subnet_name].CIDR,
    common.mgmt.repos.repohost_number) }:/srv/git'                                                                                                                      # FQDN or IP address of the server without protocol prefix. Prefix should be set by module, which uses the config
    # address: gitlab.com # FQDN or IP address of the server without protocol prefix. Prefix should be set by module, which uses the config
  port: 443
# repos configuration, used both in distributive building/supplying and in infrastructure deployment
repos:
  third_party_hosted_helm_repo: 'https://${ cidrhost({for network in common.networks:
    network.name => network}[common.mgmt.repos.subnet_name].CIDR, common.mgmt.repos.repohost_number)
    }:443/repository/third-party-hosted-repo/'
  git:
### Terraform
  - name: ansible_inventory_output
    server_name: ccfa_git
    path: ccfa-terraform/modules/universalHostAnsibleOutput
    ref: ${ common.ccfa_version }

  - name: universal_host
    server_name: ccfa_git
    path: ccfa-terraform/universalhostdeploy
    ref: ${ common.ccfa_version }

  - name: consul_kv
    server_name: ccfa_git
    path: ccfa-terraform/modules/ccfa-consul-kv
    ref: ${ common.ccfa_version }

  - name: vault
    server_name: ccfa_git
    path: ccfa-terraform/modules/vault
    ref: ${ common.ccfa_version }

  - name: k8s_jobs
    server_name: ccfa_git
    path: ccfa-terraform/modules/k8sjobs
    ref: ${ common.ccfa_version }

  - name: k8s_configs
    server_name: ccfa_git
    path: ccfa-terraform/modules/k8s
    ref: ${ common.ccfa_version }

  - name: keycloak
    server_name: ccfa_git
    path: ccfa-terraform/modules/keycloak
    ref: ${ common.ccfa_version }

  - name: minio
    server_name: ccfa_git
    path: ccfa-terraform/modules/minio
    ref: ${ common.ccfa_version }

  - name: opensearch
    server_name: ccfa_git
    path: ccfa-terraform/modules/opensearch
    ref: ${ common.ccfa_version }

  - name: nexus
    server_name: ccfa_git
    path: ccfa-terraform/modules/nexus
    ref: ${ common.ccfa_version }

### Inventories
  - name: ccfa_mgmt_inventory
    server_name: ccfa_git
    path: mcdevops1/ansible/inventories/ccfa_mgmt
    ref: ${ common.ccfa_version }

  - name: ccfa_inventory
    server_name: ccfa_git
    path: mcdevops1/ansible/inventories/ccfainventory
    ref: ${ common.ccfa_version }

### Collections
  - name: integration_iu
    server_name: ccfa_git
    path: mcdevops1/ansible/collections/integration/integrationutility
    ref: ${ common.ccfa_version }

  - name: infra_mgmt_repos
    server_name: ccfa_git
    path: mcdevops1/ansible/collections/infra/mgmt/repos
    ref: ${ common.ccfa_version }

  - name: infra_core_hashicorp
    server_name: ccfa_git
    path: mcdevops1/ansible/collections/core/hashicorp
    ref: ${ common.ccfa_version }

  - name: infra_core_common
    server_name: ccfa_git
    path: mcdevops1/ansible/collections/core/common
    ref: ${ common.ccfa_version }

  - name: infra_logging_opensearch
    server_name: ccfa_git
    path: mcdevops1/ansible/collections/logging/opensearch
    ref: ${ common.ccfa_version }

  - name: infra_monitoring_prometheus
    server_name: ccfa_git
    path: mcdevops1/ansible/collections/monitoring/prometheus
    ref: ${ common.ccfa_version }

  - name: infra_storage_postgres
    server_name: ccfa_git
    path: mcdevops1/ansible/collections/storage/postgres
    ref: ${ common.ccfa_version }

  - name: infra_core_k8s
    server_name: ccfa_git
    path: mcdevops1/ansible/collections/core/k8s
    ref: ${ common.ccfa_version }

### Terragrunt
  - name: terragrunt_framework
    server_name: ccfa_git
    path: mcdevops1/terragrunt/frameworks/default_infrastructure
    ref: ${ common.ccfa_version }
### Other

  - name: grafana_dashboards
    server_name: ccfa_git
    path: mcdevops1/grafanaDashboards
    ref: ${ common.ccfa_version }
  raw:
  - name: db_scripts-raw
    server_name: nexus
    path: ''

# terraform modules, published in Git
modules:
- name: ansible_inventory_output
  ref: ${ common.ccfa_version }
  repo_name: ansible_inventory_output
  path: ''

- name: consul_kv
  ref: ${ common.ccfa_version }
  repo_name: consul_kv
  path: ''

- name: vault
  ref: ${ common.ccfa_version }
  repo_name: vault
  path: ''

- name: universalHost
  ref: ${ common.ccfa_version }
  repo_name: universal_host
  path: modules/universalhost

- name: k8s_jobs
  ref: ${ common.ccfa_version }
  repo_name: k8s_jobs
  path: ''

- name: k8s_labels
  ref: ${ common.ccfa_version }
  repo_name: k8s_configs
  path: labels

- name: k8s_fluentd
  ref: ${ common.ccfa_version }
  repo_name: k8s_configs
  path: security/fluentd

- name: k8s_oidc_auth
  ref: ${ common.ccfa_version }
  repo_name: k8s_configs
  path: security/k8s_oidc_auth

- name: k8s_oidc_dashboard
  ref: ${ common.ccfa_version }
  repo_name: k8s_configs
  path: security/oidc_dashboard

- name: k8s_orex_operator
  ref: ${ common.ccfa_version }
  repo_name: k8s_configs
  path: security/orex_operator

- name: k8s_docker_registries
  ref: ${ common.ccfa_version }
  repo_name: k8s_configs
  path: security/private_registries

- name: k8s_sme
  ref: ${ common.ccfa_version }
  repo_name: k8s_configs
  path: security/servicemetricexporter

- name: k8s_pv
  ref: ${ common.ccfa_version }
  repo_name: k8s_configs
  path: storage/persistent_volumes/host_path

- name: k8s_pvc
  ref: ${ common.ccfa_version }
  repo_name: k8s_configs
  path: storage/persistent_volume_claims

- name: k8s_vault
  ref: ${ common.ccfa_version }
  repo_name: k8s_configs
  path: security/vault

- name: api_services
  ref: ${ common.ccfa_version }
  repo_name: k8s_configs
  path: api_services

- name: metrics_server
  ref: ${ common.ccfa_version }
  repo_name: k8s_configs
  path: security/metrics_server

- name: victoria_metrics_agent
  ref: ${ common.ccfa_version }
  repo_name: k8s_configs
  path: security/victoria_metrics_agent

- name: keycloak
  ref: ${ common.ccfa_version }
  repo_name: keycloak
  path: ''

- name: minio
  ref: ${ common.ccfa_version }
  repo_name: minio
  path: ''

- name: opensearch
  ref: ${ common.ccfa_version }
  repo_name: opensearch
  path: ''

ssh_users: # [ ] CHANGEME 18
  users_dict:
  - username: ansible
    ssh_key: ssh-rsa 
      AAAAB3NzaC1yc2EAAAADAQABAAABgQDQST46FZJcHlzX4T27pIFSSfmc6Qcc+ZL2NkqAMoXC1sD5qw4hmeW7axdU1lGbdwZF7E0ZlBJQ37QXvqYj+kFp6PXxL9ztIm/iWcU7hkX8ZDYmS4ubxt/VKiXngNBNyRb6ebRh9fjviDWEOIGrMT2YCcjHUNK33kbIDDRTbWfzTxPwJo8b15UczTbTKwMOMRw/0H9lPXzIMuMUMq1ns/of2x2xvI5nY/2WRVytU9pMOUgOAKMESlNMf/g1rprEr4V5ZXUDGUTTHYaChevKrvTHIQ6FISogfI8RvWI05CMw27Acpuz2IyYJiOr5ox0/DIXyouOiI+v2XB6aoMGztLaGU6dA5a3vuJ2ZQJb+JkcvaDg+mjU4IA4ioXG2x1qVdZO8Ho0iydcMc9HxY8dgmZK/eQRA1IfATXf+oS7jOTj90LH2eO8ufF+XOGmMlNoyk2kmKAHmJArSZ7ysznMZg/NIjf/QM5FnpIqAt0BHG7Ed/tOwo143ezUKYFPy3dxwQVs=
      ansible@MCDEVOPS
    sudoers: yes
    noPassSudo: yes
  - username: adyakonov
    ssh_key: ssh-rsa 
      AAAAB3NzaC1yc2EAAAADAQABAAACAQDQFzon2K4U3MotQL8PGXOSa7N1d765hIKTkJiyMpny9UXTSqHzCgb7eZn2pFVq42TwYojzorYDunPbiXyH2jtnI0zXVTQj0xpdctqwfwnRuLj/SMdaAUYf0zBF8Vs3nCna8qTQRvCwBdKrofjfqNPT4QDCm8Dc7zvwC3TQoSCKlNFnvIW9RCTVpoErcNQmP+ePxvJpwi8REjViDputJ2bxGj8yoqVG0VT1gTX4TNgwdluRV2YJ8QhyEATi5kGkxND7xhihvvBk71SqfFCdthqLGsMdvQcdfvmF97y3VayG+TXoRceTYjm9TG0zJpJrH02zf+KX3kPUzCHCWsoigGao6wY4GnmBTv43pHCgznhFYAppYSQDMPRcZhOIhdUHbO4FNz7xIArNu90BjUZ+ZjoRsIqxeh16PsJqPUslBxLhvBW6j54faggVfRC2sHkH+TOgl81HgFfrp1zVNo7zaOD5iOT76A60XFn4D91bCJW7goT5OMxUKrLmv+qygZxoQnqmgoHUpECzdenYC3Syx9Acfs9Fn9ipP/YDjTmFPm+lirDUCZ4p/zYhYISzHmec+ePOjrCUeDWxLpvNZ62CheaJ3e+D5VIDGe3br45mmLoPXJNki6Uc2V7/PF2+NQvAs5gWHHhZvRBvaol+1t+lDp5QeCG8toGfkPOurEPrN1PdHw==
      a.dyakonov@adyakonov
    sudoers: yes
    noPassSudo: yes
  - username: amarchenko
    ssh_key: ssh-rsa 
      AAAAB3NzaC1yc2EAAAADAQABAAABgQCxehBtgLsS/8JWS8YkyX/cOGhLxdyIXbH5iqwu2s9jSSz5vVubwx7K+MXlVPw7KFFBeWqbFfyivyylQVwNmF1gh6mFqyG02mfDEJmi0fEDRc77M177IJo+TN0/VuSu98D2B+xj/buxpQxS3PL74YfindLH15c8Vy51xd22rOVPJw1qTMWG48mpkKhc3By36MH1FDOFOqb2GWXqpgcPDYsYPv64pkdVEshaHkBzzG0VDtvdoREaaDynTiH4wUKEBKlCIm1jcc8yuLP5Sv07QvSzd24SAok6Lz1KRit0qyIT0xZ1RVgNk6Jg8bsYWgAWybnRlX4yU7xzGcEmC5H3rhjvEPwlmrNqZHzLKAPyvhlQzWrGzpkGxukxNV14ugaDAbsl9V9GngHxBgPQU4N2QUWET6QEWMQPIJqAzUYKrvfGp43h5ehk0qPmChUzvLvrcQol85vgW3Pf8CVPh5H7BEhUx1rrMoMD0zEotFRVEnA1dgthvF21Fowjs52xlRvFBG8=
      vetrenik@amarchenko
    sudoers: yes
    noPassSudo: yes
  - username: apanfilkin
    ssh_key: ssh-rsa 
      AAAAB3NzaC1yc2EAAAADAQABAAABgQDJqAEM86z1dUWzKwUmsE3HZ4K35FDO+yBuIIoN8UQri+Ee+X65dwoE6lVYZzdwCIeIMidFPNCE5NkjDccMEasPUDKuPUuBcPBTsfHa756FNBYpal7ld+ZGTADnp1mF+4+ZFQAcJ74v+RT6rEk+xNwaahxPvKLXKFgofcqWfQXAnZyVrDK86ucmGuUlwajHViVbMKH5pOfafiHB4SQahVlufcAbo+gNeS6qw2M1ryzUdNM/NdPSZrA1/cw3/jcgtqemy3DzTxGizStXdTkVCh2z9niT65WPK/jUHAJatQykG6gD9ObE7VxA+FH2LZvpRL8V2gYPFRCHSN3scS/e3HJLKXTliJBjsGgNPA2JjJMQgp4MXGVh1TZH5a0MaqQpHIjcXgDJpz4klfrBGrsvBpQlnq8f4LoK5gHgVWHRe8WGZdrHCnN1p4ZenQpqxEX1iifjOOkURLuz+Vu0vWhnEs3gMpp7Y0GhH4bLK5Tit0Qw/atMG6gXoP5EppPnl66KA8E=
      apanfilkin
    sudoers: yes
    noPassSudo: yes
  - username: ygasnikov
    ssh_key: ssh-rsa 
      AAAAB3NzaC1yc2EAAAADAQABAAACAQCgI6DClvl2LwXS8D6jh8+11Jfw5Zpwzct+bW8Eyye3i9LJ/xMPxDLCDgV+aJcl4kmbZqMKc+5cNW3agVh3tDUpwoosfJK2VRjI+IkfQmopSWZlRk/Mz4JkJNadQclcxrctMRVikhAcppbgxk+iOc7iqqYozTjECPV72XLiLttGfJ/HrUnvGDosqap7a3SQtkEbgBXSNnVQ6rCtCJcnpPZf3AGEJnX4SfWk9WBnkOK8LuIqvWxqvFlU0wX/2YSKh1FPassZeGD6mSt5o1aLh4hwARoYUFlQWNL2uEJqMcg5EkkK6QzNKGQmOxokTxmkYKqxnWcy0UMzRlC8/ClkWyIGpziEcVs7DavQJGk22h2C5KfGuidYoIDOo15aAaLgz4mIBPN5SWNMBll8iPj9AmCYVPJGBY/WaTLuhKhxZATNM4HhAvGutseuD/JPplYO3f4wErfA9q4UIWNNGNZuoARWlZxIh3tKLFeWRkU8ulPy0oyl5Ouvk1jwQlPSQyhP3AYSVOtlvDPf2fj5M9Ex1uDw5FTCvnsKVErE9s8ntnyMrRJLZST2elwmwZbFTO2D/v3iUTbYWk7oxUkFx2NrnfhWAtWyHjK11ieoWgZ3y7CUhU7g1025v2mctE8+wIVHF9S5TjooRP/dj+noryIs2b0oSFTSfAkeblS424wYm/Uusw==
      Y.Gasnikov@compassplus.com
    sudoers: yes
    noPassSudo: yes
  - username: vkotrachev
    ssh_key: ssh-rsa 
      AAAAB3NzaC1yc2EAAAADAQABAAABAQDcosFTxu0BcMoPFwPRwT2nsqYEG/vr52h4MiUn4PvzKF4itoXQo6GipszShpOPZfR0+kEuMY9uVZqDEHOW+hhuqFU5SgBC8lsR+4zXCgiGvNjl/9mGXzC1mNJ+/TyqMzmMNzW8xawMxtTRF4Ak8luPwB8cZbUVi0yuuKzZgJKjB5VplwpQT7pZK4SvgeTSwLIDaTTnjUlfMJKZObPGqVyH1WplefQwysEJ6I1WLvU9Zu+ToM841NZx9g3qDWsYkEB/mRhiMcJpT3Cv8ucQLKnMtJ5dzddGClLuh7FomlkCDRKNhXrw+7qRUJ8iUBjBBmiJGhXi8JtTfhMUb6fJ/Add
      vk@vkotrachev-ws
    sudoers: yes
    noPassSudo: yes
  - username: iogolikhin
    ssh_key: ssh-rsa 
      AAAAB3NzaC1yc2EAAAADAQABAAABgQDs7tWjrigMeiLw3hJLOKQ8dYL/2e2fz3d4rO3rM6SSydQDc+STYjjWvmS8M0baG9/ojiTi86aoDCwa6mN03kbZeeL/2yf0EZBtK32qfBwpo+dfuVOMjla8Zd7LWuT/0absSnRHlJh5JSOYlTJuVRiT05mi23czOrIwIXUjt1znwp1oQ3Gj7VKv8hmxCQzT6tqc/D5BJ8Xnek3yQfhAd1JaGczSufEXHVBnF48DeuAyEsY39A2H12HsRNCN7GogNW2RT88k5hoSzbKoeb6zORj0+PA1OyvLkHEljfIeGrlsaYeuzQN7PtafF1dN/7eaTZL1eeI4jtzHN5dZA83Acnr0kRR3vYHhvdZfPIVMwIPlK58JQpsaAXPZtES4OhBBFV1mi6yLRQYE6nYyIo3UMmoNcOJuZtF/L6f+PlaP8GoUQ71gw2boCFKmUrd+X+v3Aly8xWxuaord2QGMYNKVBcwNq0AK2WFU9Wc4clEWI/BeY3X6eOdyLd+211TObRX3OzM=
      iogolikhin
    sudoers: yes
    noPassSudo: yes
  - username: arubtsov
    ssh_key: ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMBnWjg+Phy7NuLFY+jLQzkRxNefvpkEXzxBmThahMyc
      rav@DESKTOP-EUA02H9
    sudoers: yes
    noPassSudo: yes
  - username: vdobychin
    ssh_key: ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMYmUzECCXZia7XJi1FTAKC2MZ+20fXQSD5H+FwSSQ3J
      vdobychin@compassplus.com
    sudoers: yes
    noPassSudo: yes
  - username: agolev
    ssh_key: ssh-rsa 
      AAAAB3NzaC1yc2EAAAADAQABAAABgQDxVVu8qUDjoEUDHSmcwUEtXGjGkOQQHvi9/fnYtxzCUZivHcBawYGSQtTNfYSW9amQM4cVvlDOvRr73D3NldmzxqK9ToNvFll9XVsJDAe3+s2qd0T6bK8c+jX/quYLCgqMCHgF2bJHBc8Pj2/VJreRCCjIno+sZlDcSVRDXcK70auqH9Me8/rEA8LLMHrkMO8HPVoBgMqJE41A5DcUKA4MbiXr3VARB8nrm9BTg2BL29dxfX2zIEpyvk2snyqsElYqWTgQ/G5AP7g1RjxuWfC5AFmIYvQcHzrioBLsfh/uUv9+OsTWSE6SqLiWrAGgIpQDhyTsXhVIKDrVA1NB4KXPt64BkMZzZ5ZE3BjLYRBNRoRg5UJ2hu7+ma8eEwnOAXgN/rY+kKUxYOhzyPGaJRnDPyQ7G0lIch84+F6vJySIwxIqP4gz7efJcJNXnq1ZV3eUKS5dGa0y6tMwlIUoo97wiJbP/feZqqlaPpvuSsHdpvfYHL/QjS0Crogy3WcYX7U=
      admin@agolev
    sudoers: yes
    noPassSudo: yes
  - username: arubtsov
    ssh_key: ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMBnWjg+Phy7NuLFY+jLQzkRxNefvpkEXzxBmThahMyc
      rav@DESKTOP-EUA02H9
    sudoers: yes
    noPassSudo: yes
  - username: vkotrachev
    ssh_key: ssh-rsa 
      AAAAB3NzaC1yc2EAAAADAQABAAABAQDcosFTxu0BcMoPFwPRwT2nsqYEG/vr52h4MiUn4PvzKF4itoXQo6GipszShpOPZfR0+kEuMY9uVZqDEHOW+hhuqFU5SgBC8lsR+4zXCgiGvNjl/9mGXzC1mNJ+/TyqMzmMNzW8xawMxtTRF4Ak8luPwB8cZbUVi0yuuKzZgJKjB5VplwpQT7pZK4SvgeTSwLIDaTTnjUlfMJKZObPGqVyH1WplefQwysEJ6I1WLvU9Zu+ToM841NZx9g3qDWsYkEB/mRhiMcJpT3Cv8ucQLKnMtJ5dzddGClLuh7FomlkCDRKNhXrw+7qRUJ8iUBjBBmiJGhXi8JtTfhMUb6fJ/Add
      vk@vkotrachev-ws
    sudoers: yes
    noPassSudo: yes
  - username: iogolikhin
    ssh_key: ssh-rsa 
      AAAAB3NzaC1yc2EAAAADAQABAAABgQDs7tWjrigMeiLw3hJLOKQ8dYL/2e2fz3d4rO3rM6SSydQDc+STYjjWvmS8M0baG9/ojiTi86aoDCwa6mN03kbZeeL/2yf0EZBtK32qfBwpo+dfuVOMjla8Zd7LWuT/0absSnRHlJh5JSOYlTJuVRiT05mi23czOrIwIXUjt1znwp1oQ3Gj7VKv8hmxCQzT6tqc/D5BJ8Xnek3yQfhAd1JaGczSufEXHVBnF48DeuAyEsY39A2H12HsRNCN7GogNW2RT88k5hoSzbKoeb6zORj0+PA1OyvLkHEljfIeGrlsaYeuzQN7PtafF1dN/7eaTZL1eeI4jtzHN5dZA83Acnr0kRR3vYHhvdZfPIVMwIPlK58JQpsaAXPZtES4OhBBFV1mi6yLRQYE6nYyIo3UMmoNcOJuZtF/L6f+PlaP8GoUQ71gw2boCFKmUrd+X+v3Aly8xWxuaord2QGMYNKVBcwNq0AK2WFU9Wc4clEWI/BeY3X6eOdyLd+211TObRX3OzM=
      iogolikhin
    sudoers: yes
    noPassSudo: yes
  enabled_users:
  - adyakonov
  - agolev
  - amarchenko
  - ansible
  - apanfilkin
  - arubtsov
  - iogolikhin
    # - vdobychin
    # - vkotrachev
    # - ygasnikov

### Certificates
ssl:
  certificates:
    default_cert_info:
      country_name: RU   # [ ] CHANGEME 19
      state_or_province_name: Chelyabinsk Province   # [ ] CHANGEME 19
      locality_name: Chelyabinsk   # [ ] CHANGEME 19
      organization_name: Compassplus Ltd   # [ ] CHANGEME 19
      organizational_unit_name: MobiCash SPD   # [ ] CHANGEME 19
      email_address:      # [ ] CHANGEME 19
    ca:
      create: false # [ ] CHANGEME 19 : Change if you already have issued CA cert
      common_name: CCFA-${ common.site_name}
    nexus:
      create: false
    jenkins:
      create: false
    vault:
      create: true
