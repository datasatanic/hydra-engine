{% macro dump_node(plan,id) -%}
{% if plan is mapping %}
    <ul>
        {%- for item in plan.items() %}
        {% set curId = id.uuid4().hex %}
        {% if item[0] == "resource_changes" or item[0] == "resource_drift" or item[0] == "plan" or (item[0] == "change" and item[1]["actions"][0] != "no-op") %}
        <li>
            <div class="item">
                <img src="/hydra_engine/static/Collapsed.svg" data-bs-toggle="collapse" data-bs-target="#n{{curId}}" aria-expanded="true" aria-controls="n{{curId}}"/>
                <h5>{{ item[0] }}</h5>
            </div>
            <div class="collapse show" id="n{{curId}}" >
                {{ dump_node(item[1],id) }}
            </div>
        </li>
        {% else %}
        <li>
            <div class="item">
                <img src="/hydra_engine/static/Collapsed.svg" data-bs-toggle="collapse" data-bs-target="#n{{curId}}" aria-expanded="false" aria-controls="n{{curId}}"/>
                <h5>{{ item[0] }}</h5>
            </div>
            <div class="collapse" id="n{{curId}}" >
                {{ dump_node(item[1],id) }}
            </div>
        </li>
        {% endif %}
        {%- endfor %}
    </ul>
{% elif plan is string or plan is number or plan is boolean %}
    <h5 class="variable">{{ plan }}</h5>
{% elif plan is iterable %}
    {%- for item in plan %}
        {{ dump_node(item,id) }}
    {%- endfor %}
{% endif %}
{%- endmacro %}


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link href="/hydra_engine/static/style.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>
<body>
    {{ dump_node(plan,id) }}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
</body>
</html>